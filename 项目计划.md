# 香港机场每日客流时间序列预测 - 项目计划

## 📋 项目概述

| 项目 | 详情 |
|------|------|
| **数据集** | 香港机场每日过境旅客总数 |
| **时间范围** | 2023年1月1日 - 2025年12月17日 (1082天) |
| **训练集** | 1077天 (2023-01-01 至 2025-12-12) |
| **测试集** | 5天 (2025-12-13 至 2025-12-17) |
| **课程要求** | STAT8003 时间序列预测 - 8个必答问题 |

---

## 📈 项目进度记录

### 小组分工
- **组员A (传统时间序列)**: Q1-Q5 探索性分析 + Q6 SARIMA + Q7诊断
- **组员B (深度学习)**: Q6 LSTM模型 + Q8 预测评估

### 深度学习部分进度

| 日期 | 任务 | 状态 | 备注 |
|------|------|------|------|
| 2025-12-26 | LSTM模型实现 | ✅ 完成 | 2层LSTM, 64隐藏单元 |
| 2025-12-26 | 模型训练 | ✅ 完成 | 48 epochs (早停), 最佳val_loss=0.0121 |
| 2025-12-26 | 5天预测 | ✅ 完成 | MAPE=7.26% |
| 2025-12-26 | 可视化 | ✅ 完成 | 3张图表 |

### LSTM模型结果

| 指标 | 值 |
|------|-----|
| **MAE** | 10,169 passengers |
| **RMSE** | 11,861 passengers |
| **MAPE** | 7.26% |

### 传统时间序列部分进度 (另一组员负责)

| 日期 | 任务 | 状态 | 备注 |
|------|------|------|------|
| 2025-12-18 | Task 1: 数据准备 | ✅ 完成 | 起始日期从2023-02-06改为2023-01-01 |
| 2025-12-18 | Task 2: Q1数据描述 | ✅ 完成 | 基本统计量、年度/周内模式分析 |
| 2025-12-18 | Task 3: Q2可视化 | ✅ 完成 | 生成2张图表 |
| 2025-12-18 | Task 4: Q3 ACF/PACF | ✅ 完成 | 分析原始/差分序列的自相关性 |
| 2025-12-18 | Task 5: Q4 STL分解 | ✅ 完成 | 趋势78.6%、季节11.8%、残差9.1% |
| 2025-12-18 | Task 6: Q5 平稳性检验 | ✅ 完成 | ADF+KPSS检验，确定d=1, D=1, s=7 |
| - | Task 7: Q6 SARIMA | 🔄 进行中 | 由另一组员负责 |

### 分析发现记录
1. **STL分解结果**: 趋势成分占方差78.6%，季节成分占11.8%，残差占9.1%
2. **平稳性检验**: 一阶差分即可达到平稳，但为处理周季节性建议使用SARIMA
3. **SARIMA参数建议**: (p,d,q)(P,D,Q,s) = (?,1,?)(?,1,?,7)，需要通过模型选择确定具体p,q,P,Q

### 关键决策记录
1. **起始日期选择**: 选择2023-01-01而非2023-02-06
   - 理由: 自然年开始，便于解释年度季节性（春节、暑假、圣诞）
   - 样本量: 1082天 vs 1046天，增加36天
   - 虽然1月初尚未全面通关，但客流已呈上升趋势

### 参考示例项目方法论

| 步骤 | Sample 1 (温度预测) | Sample 2 (CPI预测) | 我们的项目 |
|------|---------------------|--------------------| -----------|
| **数据转换** | 原始数据 | Log变换 | 待定(根据平稳性检验) |
| **差分** | 季节差分(365) | 月度+年度差分 | 周差分(7) + 可能的一阶差分 |
| **传统模型** | ARIMA/SARIMA | ARIMA | SARIMA (p,d,q)(P,D,Q,7) |
| **深度学习** | Transformer, N-HiTS, LSTM | LSTM | Prophet (可选) |
| **评估指标** | RMSE, MAE, MAPE | RMSE, MAE | MAE, RMSE, MAPE |
| **诊断** | 残差ACF, Ljung-Box | 残差分析, Q-Q图 | 完整诊断套件 |

---

## 🎯 任务清单 (TODO List)

### 阶段一：数据准备
- [ ] **Task 1: 数据预处理**
  - 筛选机场口岸数据 (Control_Point = 'Airport')
  - 筛选时间范围 (2023.2.6 - 2025.12)
  - 聚合每日总客流 (Arrival + Departure)
  - 分离训练集和测试集 (保留最后5天用于验证)
  - 保存处理后的数据

### 阶段二：探索性分析 (Q1-Q5)
- [ ] **Task 2: Q1 数据描述**
  - 数据来源和背景说明
  - 基本统计量 (均值、标准差、最大最小值、分位数)
  - 选择该数据集的理由

- [ ] **Task 3: Q2 时间序列可视化**
  - 绘制原始时间序列图
  - 识别并讨论：趋势、季节性、周期性、异常值
  - 绘制子序列图 (按周/月分组)

- [ ] **Task 4: Q3 ACF/PACF 分析**
  - 绘制自相关函数 (ACF) 图
  - 绘制偏自相关函数 (PACF) 图
  - 分析滞后相关性模式
  - 初步判断 AR(p) 和 MA(q) 阶数

- [ ] **Task 5: Q4 时间序列分解**
  - 进行STL分解 (周期=7，周季节性)
  - 分离：趋势 + 季节性 + 残差
  - 讨论各成分特征

- [ ] **Task 6: Q5 平稳性检验**
  - ADF检验 (Augmented Dickey-Fuller)
  - KPSS检验
  - 确定是否需要差分及差分阶数 d
  - 对差分后数据重复检验

### 阶段三：模型构建 (Q6)
- [ ] **Task 7: SARIMA模型拟合**
  - 基于ACF/PACF确定候选参数范围
  - 网格搜索最优 (p,d,q)(P,D,Q,s) 参数
  - 使用AIC/BIC准则选择最佳模型
  - 报告模型参数和拟合结果

- [ ] **Task 8: Prophet模型拟合 (可选对比)**
  - 使用Facebook Prophet拟合
  - 配置周季节性和节假日效应
  - 作为对比基准

### 阶段四：模型诊断 (Q7)
- [ ] **Task 9: 残差诊断**
  - 残差时间序列图
  - 残差ACF图
  - Q-Q图 (正态性检验)
  - Shapiro-Wilk检验
  - Ljung-Box检验 (白噪声检验)
  - 评估模型是否充分

### 阶段五：预测与评估 (Q8)
- [ ] **Task 10: 预测与评估**
  - 对最后5天进行样本外预测
  - 计算评估指标：MAE, RMSE, MAPE
  - 绘制预测图 (含95%置信区间)
  - 比较各模型表现
  - 给出最终结论

### 阶段六：报告整理
- [ ] **Task 11: 结果汇总**
  - 整理所有图表
  - 撰写分析结论
  - 按10页限制组织报告结构

---

## 🛠️ 技术栈

### Python 库
```python
# 数据处理
pandas, numpy

# 可视化
matplotlib, seaborn

# 时间序列分析
statsmodels          # ARIMA, ACF/PACF, 检验
pmdarima             # auto_arima 自动参数选择
prophet              # Facebook Prophet (可选)

# 统计检验
scipy                # Shapiro-Wilk, Ljung-Box
```

### 模型选择
| 模型 | 用途 | 优点 |
|------|------|------|
| **SARIMA** | 主模型 | 经典方法，可解释性强，课程重点 |
| **Prophet** | 对比模型 | 处理节假日效应好，自动化程度高 |

---

## 📅 建议执行顺序

```
Day 1: Task 1-3  (数据准备 + 描述 + 可视化)
Day 2: Task 4-6  (ACF/PACF + 分解 + 平稳性)
Day 3: Task 7-8  (模型拟合)
Day 4: Task 9-10 (诊断 + 预测)
Day 5: Task 11   (报告整理)
```

---

## 📁 预期输出文件

```
project/
├── data/
│   ├── immd_daily_passenger_traffic.csv    # 原始数据
│   ├── airport_daily_traffic.csv           # 处理后数据
│   └── airport_train_test.csv              # 训练/测试集
├── figures/
│   ├── 01_time_series_plot.png
│   ├── 02_acf_pacf.png
│   ├── 03_decomposition.png
│   ├── 04_residual_diagnostics.png
│   └── 05_forecast.png
├── analysis/
│   └── time_series_analysis.ipynb          # 主分析notebook
└── report/
    └── STAT8003_Project_Report.pdf         # 最终报告
```

---

*计划创建日期: 2025年12月18日*




================================================================================
香港机场每日客流数据 - 研究进度与显著性评估
================================================================================

【1. 数据概览】
  样本量: 1077 天 (n >> 100, 满足要求)
  日期范围: 2023-01-01 至 2025-12-12
  均值: 107,794 人/天
  标准差: 23,267
  变异系数: 21.6%

【2. 趋势显著性检验 (线性回归)】
  线性趋势斜率: 52.90 人/天
  R-squared: 0.5002
  p-value: 4.29e-164
  结论: *** 趋势高度显著 (p < 0.05) ***

【3. 周季节性显著性检验 (Kruskal-Wallis)】
  H统计量: 99.76
  p-value: 2.82e-19
  结论: *** 周季节性高度显著 (p < 0.05) ***

  周内各天均值:
    Mon:    109,483 (+1.6%)
    Tue:     99,687 (-7.5%)
    Wed:    100,738 (-6.5%)
    Thu:    103,862 (-3.6%)
    Fri:    112,576 (+4.4%)
    Sat:    110,866 (+2.8%)
    Sun:    117,368 (+8.9%)

【4. 月度季节性显著性检验 (Kruskal-Wallis)】
  H统计量: 174.72
  p-value: 1.26e-31
  结论: *** 月度季节性高度显著 (p < 0.05) ***

【5. 年度增长分析】
  2023年均值: 86,909
  2024年均值: 114,429
  2025年均值: 122,807
  总体增长: 41.3% (2023 -> 2025)

【6. 自相关显著性】
  95%置信区间: +/-0.0597
  Lag  1 ACF: 0.8712 *** 显著 ***
  Lag  7 ACF: 0.8149 *** 显著 ***
  Lag 14 ACF: 0.7159 *** 显著 ***

【7. STL分解结果 (方差占比)】
  趋势成分: 78.6%
  季节成分: 11.8%
  残差成分: 9.1%

================================================================================
综合评估
================================================================================

+------------------------------------------------------------------+
|  检验项目          |  结果      |  p-value       |  显著性      |
+------------------------------------------------------------------+
|  趋势              |  上升      |  < 0.001       |  *** 显著    |
|  周季节性 (s=7)    |  存在      |  < 0.001       |  *** 显著    |
|  月度季节性        |  存在      |  < 0.001       |  *** 显著    |
|  Lag-1 自相关      |  强正相关  |  -             |  *** 显著    |
|  Lag-7 自相关      |  正相关    |  -             |  *** 显著    |
+------------------------------------------------------------------+

结论: 数据具有非常显著的时间序列特征！


推荐继续使用该数据集的理由:
1. 样本量充足: 1077天 >> 100，满足课程要求
2. 趋势显著: 明显的上升趋势，可以建模
3. 周季节性显著: 周末vs工作日差异明显 (周日最高)
4. 月度季节性显著: 暑假、圣诞等假期高峰明显
5. 自相关显著: ACF/PACF有清晰模式，适合SARIMA建模
6. 方差结构清晰: 趋势占78.6%，季节占11.8%

建议: 继续使用SARIMA(p,1,q)(P,1,Q,7)模型进行预测
